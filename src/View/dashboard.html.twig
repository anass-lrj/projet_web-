{% extends 'layout.html.twig' %}

{% block content %}
    {% if currentUser is not null %}
        <h1>Bienvenue {{ currentUser.prenom }} {{ currentUser.nom }}</h1>
        <p>Ici vous avez accès à votre tableau de bord, vous pouvez voir l'ensemble de vos informations ainsi que les offres auxquelles vous avez postuler </p>
        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        Vos Informations
                    </div>
                    <div class="card-body">
                        <p><strong>Nom :</strong> {{ currentUser.nom }}</p>
                        <p><strong>Prénom :</strong> {{ currentUser.prenom }}</p>
                        <p><strong>Email :</strong> {{ currentUser.email }}</p>
                        <p><strong>Téléphone :</strong> {{ currentUser.telephone }}</p>
                    </div>
                </div>
            </div>
            {% if currentUser.role == 'admin' or currentUser.role == 'pilote' %}
            <div class="mt-4 d-flex flex-wrap gap-3">
                <a href="{{ url_for('list-racine') }}" class="btn btn-primary shadow-sm">
                    <i class="fas fa-users"></i> Voir la liste des utilisateurs
                </a>            
                <a href="{{ url_for('domaines-list') }}" class="btn btn-success shadow-sm">
                    <i class="fas fa-cogs"></i> Gérer les domaines
                </a>
            </div>
            {% endif %}
            {% if currentUser.role == 'user' %}
            <div class="col-md-12 mt-4">
                <div class="card">
                    <div class="card-header">
                        Vos Offres Postulées
                    </div>
                    <div class="card-body">
                        {% if offres is not empty %}
                            <ul class="list-group">
                                {% for offre in offres %}
                                    <li class="list-group-item">
                                        <strong>{{ offre.titre }}</strong><br>
                                        <span>{{ offre.description }}</span><br>
                                        <small>Postulé le : {{ offre.datePostulation|date('d/m/Y') }}</small>
                                    </li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            <p>Vous n'avez postulé à aucune offre pour le moment.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endif %}
    {% else %}
        <h1>Veuillez vous connecter</h1>
    {% endif %}
{% endblock %}